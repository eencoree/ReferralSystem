# Referral System API

API для регистрации пользователей по номеру телефона с подтверждением кода и реферальной системой.

## Документация

- Документирование API при помощи ReDoc: `/redoc/` 

---

## Авторизация по номеру телефона

### 1. Получение кода

**POST** `/auth/`

**Описание:** Запрос на ввод номера телефона. Имитирует отправку 4‑х значного кода авторизации

#### Пример запроса
```json
{
  "phone_number": "+777777722"
}
```

### Пример успешного ответа
```json
{
  "message": "Code is created and sent to +777777722",
  "code": "4985"
}
```

### Ошибки

- 400: Номер не передан или код запрашивается слишком часто (чаще, чем раз в 30 сек)


### 2. Подтверждение кода авторизации

**POST** `/confirm/`

**Описание:** Запрос на ввод номера телефона и кода авторизации. Если пользователь ранее не авторизовывался, то записать его в БД. При первой авторизации генерируется 6-значный инвайт-код из цифр и символов

#### Пример запроса
```json
{
  "phone_number": "+777777722",
  "code": "4985"
}
```

### Пример успешного ответа
```json
{
"message": "User authenticated",
"new_user": true
}
```

### Ошибки

- 400: Передан неверный или просроченный код
- 404: Код для данного номера не генерировался


### 3. Профиль текущего пользователя

**GET** `/profile/`

**Описание:** Запрос на получение профиля пользователя (требует аутентификации)

### Пример успешного ответа
```json
{
"phone_number": "+777777722",
"invite_code": "4uag2B",
"activated_code": "BWug2B",
"referrals": "['+7222142', '89223432']"
}
```

### 4. Профили всех пользователей

**GET** `/users/`

**Описание:** Запрос на получение списка профилей всех пользователей

### Пример успешного ответа
```json
[
  {
    "phone_number": "+777777722",
    "invite_code": "4uag2B",
    "activated_code": "BWug2B",
    "referrals": ["+7222142", "89223432"]
  }
]
```

### 5. Привязать реферальный код

**PATCH** `/code/`

**Описание:** Запрос на ввод реферального кода (требуется аутентификация). Код можно ввести один раз

### Пример запроса
```json
{
  "activated_code": "BWug2B"
}
```


### Пример успешного ответа
```json
{
"message": "Referral code successfully added"
}
```

### Ошибки
- 400: Пользователь уже активировал реферальный код
- 404: Реферальный код не существует


### 6. Удаление текущего пользователя

**DELETE** `/delete/`

**Описание:** Запрос на удаление пользователя (требуется аутентификация). Код можно ввести один раз

### Пример успешного ответа
```json
{
"message": "User deleted"
}
```